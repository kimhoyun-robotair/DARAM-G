<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="simple_rover">

    <!--Add macros for inertial calculation-->
    <xacro:include filename="$(find daramg_sim)/urdf/inertial_macros.xacro"/>
    <!--Add macros for color implementation-->
    <xacro:include filename="$(find daramg_sim)/urdf/materials.xacro"/>
    <!--Add macros for physical charateristic of wheels and chassis-->
    <xacro:include filename="$(find daramg_sim)/urdf/simple_rover.gazebo"/>
    <!--Add macros for diff drive plugin-->
    <xacro:include filename="$(find daramg_sim)/urdf/diff_drive.gazebo"/>
    <!--Add macros for RGB-D camera and 2D LiDAR-->
    <xacro:include filename="$(find daramg_sim)/urdf/sensorModule.xacro"/>
    <!--Add macros for Front Oriented RGB-D Camera-->
    <xacro:include filename="$(find daramg_sim)/urdf/forwardCam.xacro"/>
    <!--Add Robotic Arm for Simultation-->
    <xacro:include filename="$(find daramg_sim)/urdf/robotarm.xacro"/>

    <!-- 기준 프레임 -->
    <link name="base_footprint"/>

    <!-- base_footprint -> chassis (고정) -->
    <joint name="chassis_joint" type="fixed">
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <parent link="base_footprint"/>
        <child link="chassis"/>
    </joint>

    <link name="chassis">
        <visual>
        <origin xyz="0 0 0.40" rpy="0 0 0"/>
        <geometry><box size="0.6 0.4 0.2"/></geometry>
        <material name="black"/>
        </visual>
        <collision>
        <origin xyz="0 0 0.40" rpy="0 0 0"/>
        <geometry><box size="0.6 0.4 0.2"/></geometry>
        </collision>
        <xacro:inertial_box mass="7.0" x="0.6" y="0.4" z="0.2">
        <origin xyz="0 0 0.40" rpy="0 0 0"/>
        </xacro:inertial_box>
    </link>

    <xacro:mount_rgbd_front parent="chassis"
                            prefix="front_rgbd"
                            x="0.32" y="0.0" z="0.46"
                            pitch_deg="10"
                            width="320" height="240"
                            topic="camera"/>

    <!-- 차체 전중앙(x=0.0,y=0.0,z=0.55)에 마스트 설치.
        전방 카메라와 토픽 안 겹치게 cam_topic을 'mast_camera'로 둠 -->
    <xacro:mount_mast_sensors parent="chassis"
                            prefix="mast"
                            x="0.0" y="-0.15" z="0.525"
                            cam_topic="mast_camera"
                            scan_topic="mast_scan"
                            imu_topic="mast_imu"/>

    <xacro:robotarm parent="chassis"
                        prefix="arm_"
                        xyz="0.25 0.15 0.475"
                        rpy="0 0 0"
                        add_ros2_control="true"/>


    <joint name="front_left_column_joint" type="fixed">
        <origin xyz="0.25 0.20 0.30" rpy="0 0 0"/>
        <parent link="chassis"/>
        <child link="front_left_column"/>
    </joint>

    <link name="front_left_column">
        <visual>
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        <geometry><box size="0.06 0.06 0.30"/></geometry>
        <material name="blue"/>
        </visual>
        <collision>
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        <geometry><box size="0.06 0.06 0.30"/></geometry>
        </collision>
        <xacro:inertial_box mass="0.6" x="0.06" y="0.06" z="0.30">
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        </xacro:inertial_box>
    </link>

    <joint name="front_right_column_joint" type="fixed">
        <origin xyz="0.25 -0.20 0.30" rpy="0 0 0"/>
        <parent link="chassis"/>
        <child link="front_right_column"/>
    </joint>

    <link name="front_right_column">
        <visual>
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        <geometry><box size="0.06 0.06 0.30"/></geometry>
        <material name="blue"/>
        </visual>
        <collision>
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        <geometry><box size="0.06 0.06 0.30"/></geometry>
        </collision>
        <xacro:inertial_box mass="0.6" x="0.06" y="0.06" z="0.30">
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        </xacro:inertial_box>
    </link>

    <joint name="rear_left_column_joint" type="fixed">
        <origin xyz="-0.25 0.20 0.30" rpy="0 0 0"/>
        <parent link="chassis"/>
        <child link="rear_left_column"/>
    </joint>
    <link name="rear_left_column">
        <visual>
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        <geometry><box size="0.06 0.06 0.30"/></geometry>
        <material name="blue"/>
        </visual>
        <collision>
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        <geometry><box size="0.06 0.06 0.30"/></geometry>
        </collision>
        <xacro:inertial_box mass="0.6" x="0.06" y="0.06" z="0.30">
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        </xacro:inertial_box>
    </link>

    <joint name="rear_right_column_joint" type="fixed">
        <origin xyz="-0.25 -0.20 0.30" rpy="0 0 0"/>
        <parent link="chassis"/>
        <child link="rear_right_column"/>
    </joint>
    <link name="rear_right_column">
        <visual>
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        <geometry><box size="0.06 0.06 0.30"/></geometry>
        <material name="blue"/>
        </visual>
        <collision>
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        <geometry><box size="0.06 0.06 0.30"/></geometry>
        </collision>
        <xacro:inertial_box mass="0.6" x="0.06" y="0.06" z="0.30">
        <origin xyz="0 0 -0.15" rpy="0 0 0"/>
        </xacro:inertial_box>
    </link>

    <joint name="front_left_wheel_joint" type="continuous">
        <origin xyz="0 0 -0.20" rpy="0 0 0"/>
        <parent link="front_left_column"/>
        <child link="front_left_wheel"/>
        <axis xyz="0 1 0"/>
        <limit effort="100.0" velocity="10.0"/>
        <dynamics damping="1.0" friction="1.0"/>
    </joint>

    <link name="front_left_wheel">
        <visual>
        <origin xyz="0 0 0" rpy="0 1.5707 1.5707"/>
        <geometry><cylinder radius="0.1" length="0.1"/></geometry>
        <material name="green"/>
        </visual>
        <collision>
        <origin xyz="0 0 0" rpy="0 1.5707 1.5707"/>
        <geometry><cylinder radius="0.1" length="0.1"/></geometry>
        </collision>
        <xacro:inertial_cylinder mass="0.1" length="0.1" radius="0.1">
        <origin xyz="0 0 0" rpy="0 0 0"/>
        </xacro:inertial_cylinder>
    </link>

    <joint name="front_right_wheel_joint" type="continuous">
        <origin xyz="0 0 -0.20" rpy="0 0 0"/>
        <parent link="front_right_column"/>
        <child link="front_right_wheel"/>
        <axis xyz="0 1 0"/>
        <limit effort="100.0" velocity="10.0"/>
        <dynamics damping="1.0" friction="1.0"/>
    </joint>

    <link name="front_right_wheel">
        <visual>
        <origin xyz="0 0 0" rpy="0 1.5707 1.5707"/>
        <geometry><cylinder radius="0.1" length="0.1"/></geometry>
        <material name="green"/>
        </visual>
        <collision>
        <origin xyz="0 0 0" rpy="0 1.5707 1.5707"/>
        <geometry><cylinder radius="0.1" length="0.1"/></geometry>
        </collision>
        <xacro:inertial_cylinder mass="0.1" length="0.1" radius="0.1">
        <origin xyz="0 0 0" rpy="0 0 0"/>
        </xacro:inertial_cylinder>
    </link>

    <joint name="rear_left_wheel_joint" type="continuous">
        <origin xyz="0 0 -0.20" rpy="0 0 0"/>
        <parent link="rear_left_column"/>
        <child link="rear_left_wheel"/>
        <axis xyz="0 1 0"/>
        <limit effort="100.0" velocity="10.0"/>
        <dynamics damping="1.0" friction="1.0"/>
    </joint>

    <link name="rear_left_wheel">
        <visual>
        <origin xyz="0 0 0" rpy="0 1.5707 1.5707"/>
        <geometry><cylinder radius="0.1" length="0.1"/></geometry>
        <material name="green"/>
        </visual>
        <collision>
        <origin xyz="0 0 0" rpy="0 1.5707 1.5707"/>
        <geometry><cylinder radius="0.1" length="0.1"/></geometry>
        </collision>
        <xacro:inertial_cylinder mass="0.1" length="0.1" radius="0.1">
        <origin xyz="0 0 0" rpy="0 0 0"/>
        </xacro:inertial_cylinder>
    </link>

    <joint name="rear_right_wheel_joint" type="continuous">
        <origin xyz="0 0 -0.20" rpy="0 0 0"/>
        <parent link="rear_right_column"/>
        <child link="rear_right_wheel"/>
        <axis xyz="0 1 0"/>
        <limit effort="100.0" velocity="10.0"/>
        <dynamics damping="1.0" friction="1.0"/>
    </joint>

    <link name="rear_right_wheel">
        <visual>
        <origin xyz="0 0 0" rpy="0 1.5707 1.5707"/>
        <geometry><cylinder radius="0.1" length="0.1"/></geometry>
        <material name="green"/>
        </visual>
        <collision>
        <origin xyz="0 0 0" rpy="0 1.5707 1.5707"/>
        <geometry><cylinder radius="0.1" length="0.1"/></geometry>
        </collision>
        <xacro:inertial_cylinder mass="0.1" length="0.1" radius="0.1">
        <origin xyz="0 0 0" rpy="0 0 0"/>
        </xacro:inertial_cylinder>
    </link>
</robot>

